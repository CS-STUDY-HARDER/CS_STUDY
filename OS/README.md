# 운영체제

---

## 컴퓨터 시스템의 구성
### 컴퓨터 시스템 연산

현대 컴퓨터 시스템은 하나 이상의 CPU와 다수의 장치 제어들로 구성되고, 공용 버스로 연결되며 이를 이용해 공유 메모리에 접근한다. CPU와 장치 제어기는 메모리 사이클을 얻기 위해 경쟁하며 병렬 실행될 수 있다. 공유 메모리에 질서 있는 접근을보장하기 위해 메모리 제어기가 접근을 동기화 시킨다.

시스템은 부트된 상태에서 사건(event)이 발생을 기다리며 인터럽트(interrupt)에 의해 전달 받는다. 하드웨어는 언제든지 시스템 버스를 통해 CPU에 신호를 보내 인터럽트를 발생 시킬수 있다. CPU가 인터럽트시 하던 일을 중지하고, 인터럽트를 처리하기로 한 서비스 루틴의 시작 주소로 이동해 실행한다. 그 후 다시 인터럽트 된 연산을 재개한다.

### 저장장치 구조

CPU는 명령어를 오직 메모리에서 가져올 수 있으므로 실행하려는 프로그램은 메모리에 있어야 한다. 메모리는 바이트 배열을 제공한다. 각 바이트는 자신의 주소를 가지고 있고, 특정 메모리 주소에 대한 적재(load), 저장(store) 명령을 통하여 전송이 이루어진다. 적재는 메모리부터 CPU의 레지스터로 한 바이트 또는 한 워드를 옮기는 것이다. 저장은 레지스터의 내용을 메모리로 옮긴다.

폰노이만 구조 시스템에서 명령-실행 사이클은 메모리로부터 명령을 인출해 명령 레지스터에 저장한다. 이어서 명령을 해독하고 메모리로부터 피연산자를 인출하여 내부 레지스터에 저장한다. 명령을 실행한 후에 결과를 다시 메모리에 저장할 수 있다. 메모리 장치는 연속적으로 전달되는 메모리 주소에만 관심이 있다. 메모리는 이들 주소가 명령 카운터, 색인, 간접 주소, 리터럴 주소로 부터 유래되어있는지 알지 못한다.

### 입출력 구조

범용 컴퓨터 시스템은 여러 장치 제어기와 CPU들로 구성되며 공통 버스로 연결된다. 장치 제어기에 따라 하나 이상의 장치가 부착될 수 있다. SCSI(Small Computer Systems Interface) 제어기에는 7개 이상의 장치를 붙일 수 있다. 장치 제어기는 로컬 버퍼 저장장치와 특수 목적용 레지스터 집합을 관리하고 이들 사이의 데이터 전송을 담당한다.  통상적으로 OS는 각 장치 제어기마다 디바이스 드라이버를 가지고 있고, 이는 장치 제어기의 동작을 이해하고 OS의 다른 부분들에게 장치에 대한 일관된 인터페이스를 제공한다.

입출력 연산을 하기 위해 디바이스 드라이버는 장치 제어기의 적절한 레지스터에 필요한 값을 적재한다. 제어기는 자신의 로컬 버퍼로 데이터 전송을 하고 인터럽트를 이용해 완료 후 디바이스 드라이버에 통보한다. 디바이스 드라이버는 제어를 OS에게 반환한다.

인터럽트 구동 방식은 디스크 입출력 같은 대량의 데이터를 전송할 때 높은 오버헤드를 초래한다. 이 문제를 해결하기 위해 직접 메모리 접근(DMA) 장치가 사용된다. 장치 제어기는 CPU의 개입 없이 메모리로부터 자신의 버퍼 장치로부터 메모리로 데이터 블록 전체를 전송한다.

--- 

## 컴퓨터 시스템 구조

### 다중 처리기 시스템 (Multiprocessor Systems)

매우 밀접한 통신을 하는 둘 이상의 처리기들을 가지며 컴퓨터 버스, 클록, 메모리와 주변 장치를 공유한다. 현재 사용하는 다중 처리기 시스템은 두 가지 형태를 가진다.

1. 비대칭적 다중 처리

   각 처리기에 특정 태스크가 할당된다. 하나의 주 처리기가 시스템을 제어한다.  다른 처리기들은 주 처리기의 명령을 실행하거나 미리 지정된 태스크를 실행한다. 주 처리기는 작업을 스케줄하고 종속 처리기에 작업을 할당한다.

2. 대칭적 다중 처리

   가장 일반적인 시스템으로 각 처리기가  OS 기능과 프로세스를 포함한 모든 작업을 처리한다.

   ![다중프로세서](images/다중프로세서.png "다중프로세서")

--- 

## 운영체제의 구조

운영체제의 가장 중요한 하나는 다중 프로그램(multiprogramming)이 가능하다는 것이다. 다중프로그래밍은 한 명의 사용자도 여러 프로그램을 동시에 실행시킨다. 운영체제는 한 번에 여러 작업을 메모리에 적재한다. 작업들은 디스크의 작업 풀(pool) 내에 유지되 메모리의 할당을 기다린다. 메모리에 존재하는 작업의 집합은 작업 풀에 대기 중인 작업의 부분집합이다.

시분할은 다중 프로그래밍의 논리적 확장이다. 시분할 시스템에서 각 동작이나 명령은 대체로 짧은 경향이어서 각 사용자를 위해서 짧은 CPU 시간만 할당한다. 이를 위해 CPU 스케줄링과 다중 프로그래밍을 사용한다.

시분할 시스템에서 OS는 적절한 응답 시간을 보장해야 하고, 이는 종종 스와핑에 의해 달성된다. 스와핑은 프로세스를 메모리에서 디스크로 적절하게 스왑인(swap-in) 또는 스왑아웃(swap-out) 시킨다. 더 일반적인 방법으로는 가상 메모리가 있다. 이는 작업의 일부만 메모리에 적재되도 수행을 허용하는 기법이다.

---